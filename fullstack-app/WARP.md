# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

Project overview
- Full-stack app with a React (Vite) frontend and an Express backend.
- Users generate an AI-style resume and cover letter (mocked), then pay via Paystack to download a watermark-free PDF generated by the backend.

Repository layout
- backend/ — Express server exposing API routes for generation and Paystack verification, and producing PDFs with PDFKit.
- frontend/ — React app built with Vite. Calls backend APIs and integrates Paystack’s inline checkout.

Environment and tooling
- Node.js (ES modules). Backend uses "type": "module" and node-fetch v3 (ESM-only), so use Node 18+.
- Vite for the frontend dev server and build.

Required environment variables
- Backend (backend/.env):
  - PAYSTACK_SECRET=<your_paystack_secret_key>
  - PORT=8080 (optional; defaults to 8080)
- Frontend (frontend/.env):
  - VITE_API_BASE=http://localhost:8080
  - VITE_PAYSTACK_PUBLIC=<your_paystack_public_key>

Key runtime integrations
- Paystack: Frontend uses the Paystack inline modal (global PaystackPop). Ensure the following tag exists in frontend/index.html (or the main HTML template) so PaystackPop is available:
  <script src="https://js.paystack.co/v1/inline.js"></script>
- PDF generation: Backend uses PDFKit to stream a simple PDF on successful payment verification.

Important API routes (backend)
- POST /api/generate
  - Body: { name: string, experience: string, jobDescription: string }
  - Response: { resumeText: string, coverLetterText: string }
  - Notes: Currently mocked content; replace with a real AI provider later as needed.
- POST /api/verify-payment
  - Body: { reference: string }
  - Behavior: Verifies reference with Paystack using PAYSTACK_SECRET. If success, responds with application/pdf content; otherwise 400.

Common commands (Windows PowerShell)
- Install dependencies
  - Backend: cd backend; npm install
  - Frontend: cd frontend; npm install
- Start development
  - Backend: cd backend; node server.js
    - Reads PORT from backend/.env if set
  - Frontend: cd frontend; npx vite --port 5173
    - Ensure frontend/.env has VITE_API_BASE and VITE_PAYSTACK_PUBLIC
- Build frontend for production
  - cd frontend; npx vite build
- Preview built frontend locally
  - cd frontend; npx vite preview --port 4173

Linting and tests
- No linters or test frameworks are configured in the provided package.json files. If you add them later (e.g., ESLint, Vitest/Jest), document the commands here and how to run a single test.

High-level architecture and data flow
- Frontend (Vite + React)
  - UI: frontend/src/App.jsx collects user inputs (name, experience, jobDescription) and shows a preview of generated content.
  - API client: frontend/src/api.js
    - generateResume() -> POST {name, experience, jobDescription} to ${VITE_API_BASE}/api/generate
    - verifyPayment() -> POST {reference} to ${VITE_API_BASE}/api/verify-payment and expects a PDF blob on success
  - Payment: Uses PaystackPop.setup with VITE_PAYSTACK_PUBLIC. On callback, calls verifyPayment(reference), then downloads the returned PDF.
- Backend (Express)
  - server.js
    - /api/generate: Returns mock resume and cover letter text computed from inputs
    - /api/verify-payment: Calls https://api.paystack.co/transaction/verify/{reference} with Authorization: Bearer PAYSTACK_SECRET. If status success, emits a minimal PDF via PDFKit; else returns 400
  - Middleware: cors(), bodyParser.json(); dotenv for configuration

Operational notes
- CORS currently allows all origins. For restricted deployments, configure cors({ origin: [...] }).
- Ensure PAYSTACK_SECRET and VITE_PAYSTACK_PUBLIC correspond to the same Paystack account.
- In development, run backend (default on 8080) and frontend (default on 5173) concurrently in separate terminals. The frontend proxy is not configured; API base is set via VITE_API_BASE.
